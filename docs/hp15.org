# -*- Mode:Org; Coding:utf-8; fill-column:158 -*-
# ######################################################################################################################################################.H.S.##
# FILE:        readme.org
#+TITLE:       HP Voyager Programs
#+SUBTITLE:    For HP-15C
#+AUTHOR:      Mitch Richling
#+EMAIL:       http://www.mitchr.me/
#+DATE:        2024-02-03
#+DESCRIPTION: Various programs for HP Voyager series calculators
#+KEYWORDS:    Hewlett Packard RPN RPL
#+LANGUAGE:    en
#+OPTIONS:     num:t toc:nil \n:nil @:t ::t |:t ^:nil -:t f:t *:t <:t skip:nil d:nil todo:t pri:nil H:5 p:t author:t html-scripts:nil
#+SEQ_TODO:    TODO:NEW(t)                         TODO:WORK(w)    TODO:HOLD(h)    | TODO:FUTURE(f)   TODO:DONE(d)    TODO:CANCELED(c)
#+PROPERTY: header-args :eval never-export
#+HTML_HEAD: <style>body { width: 95%; margin: 2% auto; font-size: 18px; line-height: 1.4em; font-family: Georgia, serif; color: black; background-color: white; }</style>
# Change max-width to get wider output -- also note #content style below
#+HTML_HEAD: <style>body { min-width: 500px; max-width: 1024px; }</style>
#+HTML_HEAD: <style>h1,h2,h3,h4,h5,h6 { color: #A5573E; line-height: 1em; font-family: Helvetica, sans-serif; }</style>
#+HTML_HEAD: <style>h1,h2,h3 { line-height: 1.4em; }</style>
#+HTML_HEAD: <style>h1.title { font-size: 3em; }</style>
#+HTML_HEAD: <style>.subtitle { font-size: 0.6em; }</style>
#+HTML_HEAD: <style>h4,h5,h6 { font-size: 1em; }</style>
#+HTML_HEAD: <style>.org-src-container { border: 1px solid #ccc; box-shadow: 3px 3px 3px #eee; font-family: Lucida Console, monospace; font-size: 80%; margin: 0px; padding: 0px 0px; position: relative; }</style>
#+HTML_HEAD: <style>.org-src-container>pre { line-height: 1.2em; padding-top: 1.5em; margin: 0.5em; background-color: #404040; color: white; overflow: auto; }</style>
#+HTML_HEAD: <style>.org-src-container>pre:before { display: block; position: absolute; background-color: #b3b3b3; top: 0; right: 0; padding: 0 0.2em 0 0.4em; border-bottom-left-radius: 8px; border: 0; color: white; font-size: 100%; font-family: Helvetica, sans-serif;}</style>
#+HTML_HEAD: <style>pre.example { white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -o-pre-wrap; font-family: Lucida Console, monospace; font-size: 80%; background: #404040; color: white; display: block; padding: 0em; border: 2px solid black; }</style>
#+HTML_HEAD: <style>blockquote { margin-bottom: 0.5em; padding: 0.5em; background-color: #FFF8DC; border-left: 2px solid #A5573E; border-left-color: rgb(255, 228, 102); display: block; margin-block-start: 1em; margin-block-end: 1em; margin-inline-start: 5em; margin-inline-end: 5em; } </style>
# Change the following to get wider output -- also note body style above
#+HTML_HEAD: <style>#content { max-width: 60em; }</style>
#+HTML_LINK_HOME: https://www.mitchr.me/
#+HTML_LINK_UP: https://richmit.github.io/voyager/
# ######################################################################################################################################################.H.E.##

#+ATTR_HTML: :border 2 solid #ccc :frame hsides :align center
|          <r> | <l>                                 |
|    *Author:* | /{{{author}}}/                      |
|   *Updated:* | /{{{modification-time(%Y-%m-%d)}}}/ |
| *Generated:* | /{{{time(%Y-%m-%d)}}}/              |
#+ATTR_HTML: :align center
Copyright \copy {{{time(%Y)}}} Mitch Richling. All rights reserved.


* Introduction
:PROPERTIES:
:CUSTOM_ID: intro
:END:

The HP-15C was designed over 40 years ago.  By modern standards it is missing many features found in scientific calculators today; however, the HP-15C is far
more efficient than modern machines.  
#+BEGIN_QUOTE
 - Fewer keystrokes ::
   Calculations that require half a dozen keystrokes on the HP-15C might take a couple dozen keystrokes on a modern
   calculator.  
 - All functionality directly available from the keyboard ::
   Not only do modern machines require more keystrokes, but many of those keystrokes are for navigating through menus.  On the HP-15C everything is no more
   than a couple keystrokes away.
 - Great keyboard ::
   The layout is designed for speed.  Mechanically it doesn't bounce or cause double entries.  It has tactical feedback to confirm key activation.  These
   features mean long time HP-15C users can stay focused on the problem at hand while touch typing problems into the machine.
#+END_QUOTE

Most of the time I preform calculations with [[https://www.mitchr.me/SS/tools/index.html#mathNstats][specialized mathematical software]].  Still each day
brings a plethora of little, ad-hoc engineering computations for which the HP-15C is simply the fastest way to hammer out an answer -- this is what keeps the HP-15C on my desk.

All that said, I occasionally use other machines: [[https://github.com/richmit/classpad2][Classpad II]], [[https://github.com/richmit/hp42][DM-42]], fx-CG50,
HP-48GX, [[https://github.com/richmit/voyager][HP-16C/DM-16L]], & [[https://github.com/richmit/voyager][HP-12CP]].

I recommend [[https://hp-15c.homepage.t-online.de/][Torsten Manz's excellent HP-15C simulator]] software on Windows & Linux.  

- Most of the programs found here are all about efficiency: 
  - Efficient replacements for STO/RCL with complex numbers
  - Reducing the tedium of matrix computations.
- Only one is about new functionality:
  - Newton's method for functions of a complex variable


#+TOC: headlines 5

#+INCLUDE: emacs.org

* Store & Recall Complex Numbers
:PROPERTIES:
:CUSTOM_ID: storclcplx
:END:

The official user guide has a pair of example programs capable of storing and recalling complex values using a matrix for storage.  The programs here are
similar except that they use registrars for storage -- storing the real and complex parts in consecutive storage registers.

With respect to the stack, these programs attempt to behave like the built in =STO= & =RCL= functions:
 - They both preserve the stack contents
 - The =STO CLPX= program leaves the item to be stored in the X stack position

If the calculator is not already in complex mode, then it will be placed in complex mode by the program.

** Usage
:PROPERTIES:
:CUSTOM_ID: storclcplxUsage
:END:

- Inputs:
 - =STO CPLX=: The number to store is on stack level Y, and the first register index is on stack level X.  \\
               The real part of Y is stored at the register indicated by the index in X, and the complex part of Y is stored in the next consecutive register.
 - =RCL CPLX=: The first register index is on stack level X.
- The result stack:
 - =STO CPLX=: The stack is shifted down so the register index is in stack position T.
 - =RCL CPLX=: The register index in stack position X is replaced by the recalled complex number, and the other stack levels are left unchanged.
- Error Conditions
 - Given register is out of bounds: An =Error 3= will be produced & the stack contents will be invalidated.
 - Given register plus one is out of bounds: An =Error 3= will be produced, the stack contents will be invalidated, and the value in the given register will be invalidated.

** Stack Diagrams
:PROPERTIES:
:CUSTOM_ID: storclcplxStk
:END:

#+BEGIN_CENTER
*=STO_CPLX=* -- Store Complex Number
#+END_CENTER
#+ATTR_HTML: :align center :cellpadding 3em
| <c>  | <l>         | <l>         |
|      | *Before*    | *After*     |
| *T:* | t           | Reg Index   |
| *Z:* | z           | t           |
| *Y:* | Cplx Number | z           |
| *X:* | Reg Index   | Cplx Number |

#+BEGIN_CENTER
*=RCL_CPLX=* -- Recall Complex Number
#+END_CENTER
#+ATTR_HTML: :align center :cellpadding 3em
| <c>  | <l>       | <l>         |
|      | *Before*  | *After*     |
| *T:* | t         | t           |
| *Z:* | z         | z           |
| *Y:* | y         | y           |
| *X:* | Reg Index | Cplx Number |

** Resources Used
:PROPERTIES:
:CUSTOM_ID: storclcplxRes
:END:

- Internal Labels:
  - E RCL_CPLX
  - D STO_CPLX
- External Labels:
  - None
- Registers Used:
  - Two consecutive registers are used.
  - The first has its index on level X of the stack
- Matrices:
  - None


** Program Listing
:PROPERTIES:
:CUSTOM_ID: storclcplxCode
:END:

#+BEGIN_CENTER
=STO_CPLX= -- Store Complex Number
#+END_CENTER
#+ATTR_HTML: :align center :cellpadding 1em
| <l>                    |         <r> |    <c>    |              <r> |    <c>    | <l>        |
| *Keystrokes* {{{SPC}}} | *Key Codes* | {{{SPC}}} | *Stack Contents* | {{{SPC}}} | *Comments* |
| {{{c15( f LBL D )}}}   |  =42,21,14= |           |          x y z t |           |            |
| {{{c15( STO I   )}}}   |     =44 25= |           |          x y z t |           |            |
| {{{c15( R↓      )}}}   |        =33= |           |          y z t x |           |            |
| {{{c15( STO (i) )}}}   |     =44 24= |           |          y z t x |           |            |
| {{{c15( f ISG I )}}}   |  =42, 6,25= |           |          y z t x |           |            |
| {{{c15( g CLx   )}}}   |     =43 35= |           |          y z t x |           | NOP        |
| {{{c15( f Re≷Im )}}}   |     =42 30= |           |         ~y z t x |           |            |
| {{{c15( STO (i) )}}}   |     =44 24= |           |         ~y z t x |           |            |
| {{{c15( f Re≷Im )}}}   |     =42 30= |           |          y z t x |           | Ret        |
| {{{c15( g RTN   )}}}   |     =43 32= |           |                  |           |            |
#+BEGIN_CENTER
=RCL_CPLX= -- Recall Complex Number
#+END_CENTER
#+ATTR_HTML: :align center :cellpadding 1em
| <l>                    |         <r> |    <c>    |              <r> |    <c>    | <l>           |
| *Keystrokes* {{{SPC}}} | *Key Codes* | {{{SPC}}} | *Stack Contents* | {{{SPC}}} | *Comments*    |
| {{{c15( f LBL E )}}}   |  =42,21,15= |           |          x y z t |           |               |
| {{{c15( STO I   )}}}   |     =44 25= |           |          x y z t |           |               |
| {{{c15( R↓      )}}}   |        =33= |           |          y z t x |           |               |
| {{{c15( RCL (i) )}}}   |     =45 24= |           |         Cr y z t |           |               |
| {{{c15( f ISG I )}}}   |   =42,6,25= |           |         Cr y z t |           |               |
| {{{c15( g CLx   )}}}   |     =43 35= |           |         Cr y z t |           | NOP           |
| {{{c15( f Re≷Im )}}}   |     =42 30= |           |        ~Cr y z t |           |               |
| {{{c15( g CLx   )}}}   |     =43 35= |           |        ~Cr y z t |           | Disable stack |
| {{{c15( RCL (i) )}}}   |     =45 24= |           |         ~C y z t |           |               |
| {{{c15( f Re≷Im )}}}   |     =42 30= |           |          C y z t |           | Ret           |
| {{{c15( g RTN   )}}}   |     =43 32= |           |                  |           |               |

* Newton's Method for Functions of a Complex Variable
:PROPERTIES:
:CUSTOM_ID: newton
:END:

Attempts to find a root of a function of a complex variable using Newtons method.  Newton's method is iterative taking an initial guess, and generating
successive guesses that, if we are fortunate, converge to a root.  In what follows, the function is referred to as $f(x)$ and the initial guess is referred to as
$x_0$.  The final guess is referred to as $x_1$.

If the calculator is not already in complex mode, then it will be placed in complex mode by the program.

** Usage

- Running the program
  - Stack Arguments:
    - X best guess for root ($x_0$)
  - Function to solve:
    - Must be =LBL 1=
    - When called, $x$ will be on every level of the stack
    - Returns $f(x)$ to stack level Y and $f'(x)$ to stack level X.
- Exit Information
  - Exit Stack State:
    - Z: $f(x_1)$   Function value at $x_1$
    - Y: $|f(x_1)|$ Function magnitude at $x_1$
    - X: $x_1$      Root guess
  - Exit Register State:
    - R8 $\Re(x_1)$
    - R9 $\Im(x_1)$
  - Non-normal Exits:
   - *Program might not converge:*  In this case it will run forever.  If the program is interrupted it is highly likely, but not guaranteed, the last guess will
     be stored in registers 8 & 9.
   - *Evaluation error:* If the function causes an error during evaluation, the program will stop.  The last guess will be stored in R8 & R9.
   - *Zero Derivative:* If the derivative is zero, then an "Error 0" will occur.   The last guess will be stored in R8 & R9.

** Resources Used
:PROPERTIES:
:CUSTOM_ID: newtonRes
:END:

- Internal Labels:
  - D Program label
  - .1 Main loop target
- External Labels:
  - 1 function to solve
  - E RCL_CPLX
  - D STO_CPLX
- Registers Used:
  - R8 Real component of root guess
  - R9 Complex component of root guess
- Matrices:
  - None


** Program Listing
:PROPERTIES:
:CUSTOM_ID: newtonCode
:END:

#+BEGIN_CENTER
=NEWTON= -- Newton's Method for a Function of a Complex Variable
#+END_CENTER
#+ATTR_HTML: :align center :cellpadding 1em
| <l>                    |         <r> |    <c>    |              <r> |    <c>    | <l>                 |
| *Keystrokes* {{{SPC}}} | *Key Codes* | {{{SPC}}} | *Stack Contents* | {{{SPC}}} | *Comments*          |
| {{{c15( f LBL C  )}}}  |  =42,21,13= |           |         x0 ? ? ? |           |                     |
| {{{c15( 8        )}}}  |         =8= |           |         8 x0 ? ? |           |                     |
| {{{c15( GSB D    )}}}  |     =32 14= |           |         x0 ? ? 8 |           | STO_CPLX            |
| {{{c15( f LBL .1 )}}}  |  =42,21,.1= |           |          ? ? ? ? |           |                     |
| {{{c15( 8        )}}}  |         =8= |           |          8 ? ? ? |           |                     |
| {{{c15( GSB E    )}}}  |     =32 15= |           |         x0 ? ? ? |           | RCL_CPLX            |
| {{{c15( ENTER    )}}}  |        =36= |           |        x0 x0 ? ? |           | x0=Previous iterate |
| {{{c15( ENTER    )}}}  |        =36= |           |       x0 x0 x0 ? |           |                     |
| {{{c15( ENTER    )}}}  |        =36= |           |      x0 x0 x0 x0 |           |                     |
| {{{c15( GSB 1    )}}}  |     =32  1= |           |         df f ? ? |           | Function to solve   |
| {{{c15( x≷y      )}}}  |        =34= |           |         f df ? ? |           | f=f(x0), df=f'(x0)  |
| {{{c15( ENTER    )}}}  |        =36= |           |         f f df ? |           |                     |
| {{{c15( ENTER    )}}}  |        =36= |           |         f f f df |           |                     |
| {{{c15( 8        )}}}  |         =8= |           |         8 f f df |           |                     |
| {{{c15( GSB E    )}}}  |     =32 15= |           |        x0 f f df |           | RCL_CPLX            |
| {{{c15( g R↑     )}}}  |     =43 33= |           |        df x0 f f |           |                     |
| {{{c15( g R↑     )}}}  |     =43 33= |           |        f df x0 f |           |                     |
| {{{c15( x≷y      )}}}  |        =34= |           |        df f x0 f |           |                     |
| {{{c15( ÷        )}}}  |        =10= |           |      f÷df x0 f f |           |                     |
| {{{c15( x≷y      )}}}  |        =34= |           |      x0 f÷df f f |           |                     |
| {{{c15( ENTER    )}}}  |        =36= |           |     x0 x0 f÷df f |           |                     |
| {{{c15( R↓       )}}}  |        =33= |           |     x0 f÷df f x0 |           |                     |
| {{{c15( x≷y      )}}}  |        =34= |           |     f÷df x0 f x0 |           |                     |
| {{{c15( -        )}}}  |        =30= |           |       x1 f x0 x0 |           | x1=Current iterate  |
| {{{c15( 8        )}}}  |         =8= |           |        8 x1 f x0 |           |                     |
| {{{c15( GSB D    )}}}  |     =32 14= |           |        x1 f x0 8 |           | STO_CPLX            |
| {{{c15( x≷y      )}}}  |        =34= |           |        f x1 x0 8 |           |                     |
| {{{c15( ENTER    )}}}  |        =36= |           |       f f  x1 x0 |           |                     |
| {{{c15( g ABS    )}}}  |     =43 16= |           |       fM f x1 x0 |           | fM=abs(f(x1))       |
| {{{c15( 1        )}}}  |         =1= |           |        1 fM f x1 |           |                     |
| {{{c15( EEX      )}}}  |        =26= |           |        1 fM f x1 |           |                     |
| {{{c15( 7        )}}}  |         =7= |           |      1e7 fM f x1 |           |                     |
| {{{c15( CHS      )}}}  |        =16= |           |        e fM f x1 |           | e=Epsilon           |
| {{{c15( g TEST 8 )}}}  |  =43,30, 8= |           |        e fM f x1 |           | y>x?                |
| {{{c15( GTO .1   )}}}  |     =22 .1= |           |        e fM f x1 |           |                     |
| {{{c15( g R↑     )}}}  |     =43 33= |           |        x1 e fM f |           |                     |
| {{{c15( x≷y      )}}}  |        =34= |           |        e x1 fM f |           |                     |
| {{{c15( R↓       )}}}  |        =33= |           |        x1 fM f e |           |                     |
| {{{c15( g RTN    )}}}  |     =43 32= |           |        x1 fM f e |           |                     |

* Matrix Helpers
:PROPERTIES:
:CUSTOM_ID: mat
:END:

These programs don't do anything the HP-15C can't already do.  They serve two purposes: 1) Reduce the number of keystrokes required, and 2) Free the user from
remembering the strange incantations required to work with complex matrices.

** Fill a Matrix
:PROPERTIES:
:CUSTOM_ID: matFill
:END:

*** Usage
:PROPERTIES:
:CUSTOM_ID: matFillUsage
:END:

This program provides a fast way to fill a matrix -- generally cuts keystroke overhead in half.

When flag 8 is set, the real & complex parts of the number in the X stack level are used to fill consecutive matrix elements resulting in a =C= format matrix.
This behavior is handy if we need to do computation with the elements before we store them -- like converting them to rectangular form with {{{c15(→R)}}}.  On
the other hand, if the complex matrix elements are known and in rectangular format, then it may be faster to clear flag 8 and enter the real and complex parts
separately.

 - Operation
   - Run the program with the following inputs: 
     - *=Z=*: A matrix descriptor or number 0 (a 0 indicates the {{{c15(A)}}} matrix should be used)
     - *=Y=*: number of rows
     - *=X=*: Number of columns
   - The matrix element coordinate will appear on the display in =r.c= format.
   - The previously entered element, if there was one, will be on level =Y= of the stack.
   - Enter the value for the matrix position and press {{{c15(R/S)}}}.
     - If flag 8 is set, then the real and complex parts will be placed into the matrix in consecutive positions.
   - Repeat until all the matrix elements have been entered.
   - Note the program never ends -- it just wraps back to the start.

*** Resources Used
:PROPERTIES:
:CUSTOM_ID: matFillRes
:END:

- Internal Labels:
  - 7 Program label
  - .7 Main loop target
  - .6 Complex if target
- External Labels:
  - None
- Registers Used:
  - R0 Matrix indexing
  - R1 Matrix indexing
  - I  Matrix descripter
- Matrices:
  - Matrix on stack level X when the program starts, or matrix A if X was zero.

*** Program Listing
:PROPERTIES:
:CUSTOM_ID: matFillCode
:END:

#+BEGIN_CENTER
=FILL_MAT= -- Fill a Matrix
#+END_CENTER
#+ATTR_HTML: :align center :cellpadding 1em
| <l>                         |         <r> |    <c>    |              <r> |    <c>    | <l>                              |
| *Keystrokes* {{{SPC}}}      | *Key Codes* | {{{SPC}}} | *Stack Contents* | {{{SPC}}} | *Comments*                       |
| {{{c15( f LBL 7        )}}} |  =42,21, 7= |           |     n m MATor0 t |           |                                  |
| {{{c15( RCL MATRIX A   )}}} |  =45,16,11= |           |     A n m MATor0 |           |                                  |
| {{{c15( STO I          )}}} |     =44 25= |           |     A n m MATor0 |           |                                  |
| {{{c15( g R↑           )}}} |     =43 33= |           |     MATor0 A n m |           |                                  |
| {{{c15( g TEST 0       )}}} |  =43,30, 0= |           |     MATor0 A n m |           |                                  |
| {{{c15( STO I          )}}} |     =44 25= |           |          A A n m |           | Sto given matrix descriptor in I |
| {{{c15( R↓             )}}} |        =33= |           |     A n m MATor0 |           |                                  |
| {{{c15( R↓             )}}} |        =33= |           |     n m MATor0 A |           |                                  |
| {{{c15( f DIM I        )}}} |  =42,23,25= |           |     n m MATor0 A |           | Dim given matrix                 |
| {{{c15( f MATRIX 1     )}}} |  =42,16, 1= |           |     n m MATor0 A |           | Set R0 & R1 to 1                 |
| {{{c15( LBL .7         )}}} |  =42,21,.7= |           |      ?orXp ? ? ? |           | Ep -- previously entered element |
| {{{c15( .              )}}} |        =48= |           |      - ?orXp ? ? |           |                                  |
| {{{c15( 1              )}}} |         =1= |           |      1 ?orXp ? ? |           |                                  |
| {{{c15( RCL × 1        )}}} |  =45,20, 1= |           |   j/10 ?orXp ? ? |           |                                  |
| {{{c15( RCL + 0        )}}} |  =45,40, 0= |           | j/10+i ?orXp ? ? |           |                                  |
| {{{c15( R/S            )}}} |        =31= |           |     j/10+i ? ? ? |           |                                  |
| {{{c15( f USER STO (i) )}}} | =u   44 24= |           |         Xr ? ? ? |           |                                  |
| {{{c15( f USER         )}}} |           - |           |         Xr ? ? ? |           | Exit USER mode                   |
| {{{c15( g CF 9         )}}} |  =43, 5, 9= |           |         Xr ? ? ? |           | NOP                              |
| {{{c15( g F? 8         )}}} |  =43, 6, 8= |           |         Xr ? ? ? |           |                                  |
| {{{c15( GTO .6         )}}} |     =22 .6= |           |         Xr ? ? ? |           |                                  |
| {{{c15( GTO .7         )}}} |     =22 .7= |           |         Xr ? ? ? |           |                                  |
| {{{c15( f LBL .6       )}}} |  =42,21,.6= |           |         Xr ? ? ? |           |                                  |
| {{{c15( f Re≷Im        )}}} |     =42 30= |           |         Xc ? ? ? |           |                                  |
| {{{c15( f USER STO (i) )}}} | =u   44 24= |           |         Xc ? ? ? |           |                                  |
| {{{c15( f USER         )}}} |           - |           |         Xc ? ? ? |           | Exit USER mode                   |
| {{{c15( g CF 9         )}}} |  =43, 5, 9= |           |         Xc ? ? ? |           | NOP                              |
| {{{c15( f Re≷Im        )}}} |     =42 30= |           |         Xr ? ? ? |           | So Xp will be in Y for R/S       |
| {{{c15( GTO .7         )}}} |     =22 .7= |           |         Xr ? ? ? |           |                                  |
| {{{c15( g RTN          )}}} |     =43 32= |           |          ? ? ? ? |           | Never Get Here                   |

** Dump a Matrix
:PROPERTIES:
:CUSTOM_ID: matDump
:END:

*** Usage
:PROPERTIES:
:CUSTOM_ID: matDumpUsage
:END:

This program provides a fast way interate over the elements of a real or complex matrix.

 - Operation
   - Run the program with the matrix descriptor or the number 0 in stack level X.  
     - If X is zero, then the {{{c15(RESULT)}}} matrix will be used.
   - Press {{{c15(R/S)}}} until all you have seen the elements you need
     - Note the program will wrap around to the first element after the last one is displayed -- this is a feature.
     - If flag 8 is set, then *pairs* of elements are pulled from the matrix and placed on the stack as complex numbers

*** Resources Used
:PROPERTIES:
:CUSTOM_ID: matDumpRes
:END:

- Internal Labels:
  - 4 Program label
  - .4 Main loop target
  - .8 Complex if target
- External Labels:
  - None
- Flags:
  - 8 -- Option flag (complex mode)
  - 9 -- CF used as NOP
- Registers Used:
  - R0 Matrix indexing
  - R1 Matrix indexing
  - I  Matrix descripter
- Matrices:
  - Matrix on stack level X when the program starts, or {{{c15(RESULT)}}} if X was zero.


*** Program Listing
:PROPERTIES:
:CUSTOM_ID: matDumpCode
:END:

#+BEGIN_CENTER
=DUMP_MAT= -- Dump a Matrix
#+END_CENTER
#+ATTR_HTML: :align center :cellpadding 1em
| <l>                         |         <r> |    <c>    |               <r> |    <c>    | <l>              |
| *Keystrokes* {{{SPC}}}      | *Key Codes* | {{{SPC}}} |  *Stack Contents* | {{{SPC}}} | *Comments*       |
| {{{c15( f LBL 4        )}}} |  =42,21, 4= |           |      MATor0 y z t |           |                  |
| {{{c15( RCL RESULT     )}}} |     =45 26= |           | RESULT MATor0 y z |           |                  |
| {{{c15( STO I          )}}} |     =44 25= |           | RESULT MATor0 y z |           |                  |
| {{{c15( R↓             )}}} |        =33= |           | MATor0 y z RESULT |           |                  |
| {{{c15( g TEST 0       )}}} |  =43,30, 0= |           | MATor0 y z RESULT |           |                  |
| {{{c15( STO I          )}}} |     =44 25= |           | MATor0 y z RESULT |           |                  |
| {{{c15( f MATRIX 1     )}}} |  =42,16, 1= |           | MATor0 y z RESULT |           | Set R0 & R1 to 1 |
| {{{c15( LBL .4         )}}} |  =42,21,.4= |           |           ? ? ? ? |           |                  |
| {{{c15( f USER RCL (i) )}}} | =u   45 24= |           |      M(i)_r ? ? ? |           |                  |
| {{{c15( f USER         )}}} |           - |           |      M(i)_r ? ? ? |           | Exit USER mode   |
| {{{c15( g CF 9         )}}} |  =43, 5, 9= |           |      M(i)_r ? ? ? |           | NOP              |
| {{{c15( g F? 8         )}}} |  =43, 6, 8= |           |      M(i)_r ? ? ? |           |                  |
| {{{c15( GTO .8         )}}} |     =22 .8= |           |      M(i)_r ? ? ? |           |                  |
| {{{c15( R/S            )}}} |        =31= |           |      M(i)_r ? ? ? |           |                  |
| {{{c15( GTO .4         )}}} |     =22 .4= |           |      M(i)_r ? ? ? |           |                  |
| {{{c15( f LBL .8       )}}} |  =42,21,.8= |           |      M(i)_r ? ? ? |           |                  |
| {{{c15( f USER RCL (i) )}}} | =u   45 24= |           |      M(i)_c ? ? ? |           |                  |
| {{{c15( f USER         )}}} |           - |           |      M(i)_c ? ? ? |           | Exit USER mode   |
| {{{c15( g CF 9         )}}} |  =43, 5, 9= |           |      M(i)_c ? ? ? |           | NOP              |
| {{{c15( f I            )}}} |     =42 25= |           |      M(i)_r ? ? ? |           |                  |
| {{{c15( R/S            )}}} |        =31= |           |      M(i)_r ? ? ? |           |                  |
| {{{c15( GTO .4         )}}} |     =22 .4= |           |      M(i)_r ? ? ? |           |                  |
| {{{c15( g RTN          )}}} |     =43 32= |           |               N/A |           | Never Get Here   |

** Solve Linear System
:PROPERTIES:
:CUSTOM_ID: matSlv
:END:

*** Usage
:PROPERTIES:
:CUSTOM_ID: matSlvUsage
:END:

This program solves the system $AX=B$ for $X$.  

- Program start conditions
  - The $A$ matrix is assumed to be in {{{c15(A)}}}.  
    - It may be an $n\times n$ real matrix, or an  $n\times 2n$ complex matrix in =C= format.
    - The program determines real vs. complex from the matrix size.
  - The $B$ matrix in {{{c15(B)}}}.  
  - Flag 1 is set appropriately:
    - Clear: Use more memory, but preserve contents of {{{c15(A)}}}.
    - Set: Use less memory, but destroy contents of {{{c15(A)}}}.
- Program end conditions
  - The system "solution", $X$, will be in {{{c15(C)}}}.  Note this might not be a valid solution if $A$ is singular!
  - {{{c15(B)}}} is left unchanged!
  - The matrix descriptor for {{{c15(C)}}} will be in stack position Y.
  - Matrix {{{c15(C)}}} will be selected as the {{{c15(RESULT)}}} matrix.
  - Both =R0= & =R1= will contain 1 in expectation {{{c15(USER)}}} mode will be used to visit the elements of {{{c15(C)}}}.
  - If $A$ is a real matrix:
    - Flag 0 will be clear
    - $\vert A\vert$ is in stack position X
    - The LU factorization of $A$ is in {{{c15(E)}}} when flag 1 is clear, and in {{{c15(A)}}} otherwise
  - If $A$ is a complex matrix
    - Flag 0 will be set
    - $\mathrm{abs}(\vert A\vert)$ is in stack position X
    - The LU factorization of $\tilde{A}$ is in {{{c15(E)}}} when flag 1 is clear, and in {{{c15(A)}}} otherwise

*** Resources Used
:PROPERTIES:
:CUSTOM_ID: matSlvRes
:END:

- Internal Labels:
  - 8 Program label
- External Labels:
  - 9 Subroutine to compute determinant
- Flags:
  - 0 -- Status flag
  - 1 -- Option flag
- Registers:
  - None
- Matrices:
  - A
  - B
  - C
  - E -- only when flag 1 is clear

*** Program Listing
:PROPERTIES:
:CUSTOM_ID: matSlvCode
:END:

#+BEGIN_CENTER
=LIN_SLV= -- Solve $AX=B$
#+END_CENTER
#+ATTR_HTML: :align center :cellpadding 1em
| <l>                       |         <r> |    <c>    |                               <r> |    <c>    | <l>        |
| *Keystrokes* {{{SPC}}}    | *Key Codes* | {{{SPC}}} |                  *Stack Contents* | {{{SPC}}} | *Comments* |
| {{{c15( f LBL 8      )}}} |  =42,21, 8= |           |                           x y z t |           |            |
| {{{c15( GSB 9        )}}} |     =32  9= |           |         DET(A)orABS(DET(A)) ? ? ? |           |            |
| {{{c15( RCL MATRIX B )}}} |  =45,16,12= |           |     BorBc DET(A)orABS(DET(A)) ? ? |           |            |
| {{{c15( g F? 0       )}}} |  =43, 6, 0= |           |     BorBc DET(A)orABS(DET(A)) ? ? |           |            |
| {{{c15( f Py\,x      )}}} |     =42 40= |           |     BorBp DET(A)orABS(DET(A)) ? ? |           |            |
| {{{c15( RCL RESULT   )}}} |     =45 26= |           |   LU~ BorBp DET(A)orABS(DET(A)) ? |           |            |
| {{{c15( f RESULT C   )}}} |  =42,26,13= |           |   LU~ BorBp DET(A)orABS(DET(A)) ? |           |            |
| {{{c15( ÷            )}}} |        =10= |           |     CorCp DET(A)orABS(DET(A)) ? ? |           |            |
| {{{c15( g F? 0       )}}} |  =43, 6, 0= |           |     CorCp DET(A)orABS(DET(A)) ? ? |           |            |
| {{{c15( g Cy\,x      )}}} |     =43 40= |           |     CorCc DET(A)orABS(DET(A)) ? ? |           |            |
| {{{c15( x≷y          )}}} |        =34= |           |     DET(A)orABS(DET(A)) CorCc ? ? |           |            |
| {{{c15( f MATRIX 1   )}}} |  =42,16, 1= |           |     DET(A)orABS(DET(A)) CorCc ? ? |           |            |
| {{{c15( RCL MATRIX B )}}} |  =45,16,12= |           | BorBp DET(A)orABS(DET(A)) CorCc ? |           |            |
| {{{c15( g F? 0       )}}} |  =43, 6, 0= |           | BorBp DET(A)orABS(DET(A)) CorCc ? |           |            |
| {{{c15( g Cy\,x      )}}} |     =43 40= |           | BorBc DET(A)orABS(DET(A)) CorCc ? |           |            |
| {{{c15( R↓           )}}} |        =33= |           | DET(A)orABS(DET(A)) CorCc ? BorBc |           |            |
| {{{c15( g RTN        )}}} |     =43 32= |           | DET(A)orABS(DET(A)) CorCc ? BorBc |           |            |

** Matrix Determinants
:PROPERTIES:
:CUSTOM_ID: matDet
:END:

*** Usage
:PROPERTIES:
:CUSTOM_ID: matDetUsage
:END:

- Program start conditions
  - The $A$ matrix is assumed to be in {{{c15(A)}}}.  
    - It may be an $n\times n$ real matrix, or an  $n\times 2n$ complex matrix in =C= format.
    - The program determines real vs. complex from the matrix size.
  - flag 1 is set appropriately:
    - Clear: Use more memory, but preserve contents of {{{c15(A)}}}.
    - Set: Use less memory, but destroy contents of {{{c15(A)}}}.
- Program end conditions
  - The previous contents of the stack are lost
  - If flag 1 is clear
    - {{{c15(A)}}} is left unchanged!
    - {{{c15(RESULT)}}} matrix set as {{{c15(E)}}}
  - If flag 1 is set
    - {{{c15(RESULT)}}} matrix set as {{{c15(A)}}}
  - $A$ is a real matrix
    - Flag 0 will be clear
    - The $\vert A\vert$ is in stack position X
    - The LU factorization of $A$ is in {{{c15(E)}}} when flag 1 is clear, and in {{{c15(A)}}} otherwise
  - If $A$ is a complex matrix
    - Flag 0 will be set
    - $\mathrm{abs}(\vert A\vert)$ is in stack position X
    - The LU factorization of $\tilde{A}$ is in {{{c15(E)}}} when flag 1 is clear, and in {{{c15(A)}}} otherwise

*** Resources Used
:PROPERTIES:
:CUSTOM_ID: matDetRes
:END:

- Internal Labels:
  - 9 -- Program label
  - .9 -- Conditional label
- External Labels:
  - N/A
- Flags:
  - 0 -- exit flag
  - 1 -- option flag
- Registers:
  - N/A
- Matrices:
  - A
  - E -- only when flag 1 is clear

*** Program Listing
:PROPERTIES:
:CUSTOM_ID: matDetCode
:END:

#+BEGIN_CENTER
=DET_A= -- Determinant of A
#+END_CENTER
#+ATTR_HTML: :align center :cellpadding 1em
| <l>                       |         <r> |    <c>    |                   <r> |    <c>    | <l>                            |
| *Keystrokes* {{{SPC}}}    | *Key Codes* | {{{SPC}}} |      *Stack Contents* | {{{SPC}}} | *Comments*                     |
| {{{c15( f LBL 9      )}}} |  =42,21, 9= |           |               x y z t |           |                                |
| {{{c15( f RESULT E   )}}} |  =42,26,15= |           |               x y z t |           |                                |
| {{{c15( g F? 1       )}}} |  =43, 6, 1= |           |               x y z t |           |                                |
| {{{c15( f RESULT A   )}}} |  =42,26,11= |           |               x y z t |           |                                |
| {{{c15( RCL DIM A    )}}} |  =45,23,11= |           |               n m x y |           |                                |
| {{{c15( g TEST 5     )}}} |  =43,30, 5= |           |               n m x y |           |                                |
| {{{c15( GTO .9       )}}} |     =22 .9= |           |               n m x y |           |                                |
| {{{c15( g SF 0       )}}} |  =43, 4, 0= |           |               n m x y |           |                                |
| {{{c15( RCL MATRIX A )}}} |  =45,16,11= |           |               A n m x |           |                                |
| {{{c15( f Py\,x      )}}} |     =42 40= |           |              Ap n m x |           |                                |
| {{{c15( f MATRIX 2   )}}} |  =42,16, 2= |           |              A~ n m x |           |                                |
| {{{c15( f MATRIX 9   )}}} |  =42,16, 9= |           | SQ(ABS(DET(A))) n m x |           |                                |
| {{{c15( g ABS        )}}} |     =43 16= |           | SQ(ABS(DET(A))) n m x |           | If roundoff made it negative   |
| {{{c15( √x           )}}} |        =11= |           |     ABS(DET(A)) n m x |           |                                |
| {{{c15( F? 1         )}}} |  =43, 6, 1= |           |     ABS(DET(A)) n m x |           |                                |
| {{{c15( g RTN        )}}} |     =43 32= |           |     ABS(DET(A)) n m x |           | Rtn when A cplx & flag 1 set   |
| {{{c15( RCL MATRIX A )}}} |  =45,16,11= |           |    A~ ABS(DET(A)) n m |           | Restore A to Ac form           |
| {{{c15( f MATRIX 3   )}}} |  =42,16, 3= |           |    Ap ABS(DET(A)) n m |           |                                |
| {{{c15( g Cy\,x      )}}} |     =43 40= |           |    Ac ABS(DET(A)) n m |           |                                |
| {{{c15( R↓           )}}} |        =33= |           |    ABS(DET(A)) x y Ac |           |                                |
| {{{c15( g RTN        )}}} |     =43 32= |           |    ABS(DET(A)) Cc x x |           | Rtn when A cplx & flag 1 clear |
| {{{c15( LBL .9       )}}} |  =42,21,.9= |           |               n m x y |           |                                |
| {{{c15( g CF 0       )}}} |  =43, 5, 0= |           |               n m x y |           |                                |
| {{{c15( RCL MATRIX A )}}} |  =45,16,11= |           |               A n m x |           |                                |
| {{{c15( f MATRIX 9   )}}} |  =42,16, 9= |           |          DET(A) n m x |           |                                |
| {{{c15( g RTN        )}}} |     =43 32= |           |          DET(A) n m x |           | Rtn when A real                |

* Summary Resource Use
** Labels
:PROPERTIES:
:CUSTOM_ID: resSumLab
:END:

#+ATTR_HTML: :border 2 solid #ccc :frame hsides :align center
|      <c>       | <l>                                    |                                                        |      <c>       | <l>                      |
| {{{c15(LBL)}}} | Use                                    |                                                        | {{{c15(LBL)}}} | Use                      |
|----------------+----------------------------------------+--------------------------------------------------------+----------------+--------------------------|
|      =0=       | Unused                                 |                                                        |      =.0=      | Unused                   |
|      =1=       | Solver/Integrator/[[#newton][Newton]]  | {{{SPC}}}{{{SPC}}}{{{SPC}}}{{{SPC}}}{{{SPC}}}{{{SPC}}} |      =.1=      | Used in {{{c15(LBL C)}}} |
|      =2=       | Solver/Integrator                      |                                                        |      =.2=      | Unused                   |
|      =3=       | Solver/Integrator                      |                                                        |      =.3=      | Unused                   |
|      =4=       | [[#matDump][Dump A Matrix]]            |                                                        |      =.4=      | Used in {{{c15(LBL 4)}}} |
|      =5=       | Unused                                 |                                                        |      =.5=      | Unused                   |
|      =6=       | Unused                                 |                                                        |      =.6=      | Used in {{{c15(LBL 7)}}} |
|      =7=       | [[#matFill][Fill A Matrix]]            |                                                        |      =.7=      | Used in {{{c15(LBL 7)}}} |
|      =8=       | [[#matSlv][Solve Real  Linear System]] |                                                        |      =.8=      | Used in {{{c15(LBL 4)}}} |
|      =9=       | [[#matDet][Real Determinant]]          |                                                        |      =.9=      | Used in {{{c15(LBL 9)}}} |
|----------------+----------------------------------------+--------------------------------------------------------+----------------+--------------------------|
|      =A=       | Unused                                 |                                                        |                |                          |
|      =B=       | Unused                                 |                                                        |                |                          |
|      =C=       | [[#newton][Complex Newton's Method]]   |                                                        |                |                          |
|      =D=       | [[#storclcplx][Store Complex Number]]  |                                                        |                |                          |
|      =E=       | [[#storclcplx][Recall Complex Number]] |                                                        |                |                          |

** Registers
:PROPERTIES:
:CUSTOM_ID: resSumReg
:END:

How I normally use register storage.  


#+ATTR_HTML: :border 2 solid #ccc :frame hsides :align center
|     <c>     | <l>                            | <l>                                     |
|  Registers  | Use In Programs                | Interactive Use                         |
|-------------+--------------------------------+-----------------------------------------|
|  =0= - =1=  | Always for matrix indexes$^1$  | Whatever, but usually as matrix indexes |
|  =2= - =7=  | Always for statistics$^1$      | Whatever, but usually for statistics    |
|  =8= - =9=  | User visible program registers | Whatever, but usually for programs      |
| =.0= - =.6= | Whatever                       | Whatever                                |
| =.7= - =.9= | Unit conversion factors$^2$    | Unit conversion factors                 |


 1) I avoid using the matrix & staticial registers in programs because I ocassionally use matrix & statstical functions in solver programs.  For example, if I
    had used thes registers in the [[#newton][Complex Newton's Method]] program then I wouldn't be able to do that.
 2) Conversions: in to cm, lb to kg, US gal to liters.  Keys =7= to =9= mirror unit conversion keys on another calculator. =;)=

** Matrix Registers
:PROPERTIES:
:CUSTOM_ID: resSumMat
:END:

How I normally use matrix storage.  These habits have strongly influenced the matrix helper routines.  

#+ATTR_HTML: :border 2 solid #ccc :frame hsides :align center
|        <c>        | <l>                                                                  |
| {{{c15(MATRIX)}}} | Use                                                                  |
|-------------------+----------------------------------------------------------------------|
|        =A=        | Determinants & LHS of matrix equations ($AX=B$)                      |
|        =B=        | RHS of matrix equations ($AX=B$)                                     |
|        =C=        | Solution for $AX=B$                                                  |
|        =D=        | Unused                                                               |
|        =E=        | $LU$ of $A$ for determinants & matrix equations when flag 1 is clear |
|                   |                                                                      |

* Meta Data

The primary URL for this page: https://richmit.github.io/voyager/hp15.html

The org mode file for this page: https://github.com/richmit/voyager/blob/main/docs/hp15.org

The HTML file for this page: https://github.com/richmit/voyager/blob/main/docs/hp15.html

The github repository housing this content: https://github.com/richmit/voyager/




