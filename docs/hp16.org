# -*- Mode:Org; Coding:utf-8; fill-column:158 -*-
# ######################################################################################################################################################.H.S.##
# FILE:        readme.org
#+TITLE:       HP Voyager Programs
#+SUBTITLE:    ForHP-16C
#+AUTHOR:      Mitch Richling
#+EMAIL:       http://www.mitchr.me/
#+DATE:        2024-02-03
#+DESCRIPTION: Various programs for HP Voyager series calculators
#+KEYWORDS:    Hewlett Packard RPN RPL
#+LANGUAGE:    en
#+OPTIONS:     num:t toc:nil \n:nil @:t ::t |:t ^:nil -:t f:t *:t <:t skip:nil d:nil todo:t pri:nil H:5 p:t author:t html-scripts:nil
#+SEQ_TODO:    TODO:NEW(t)                         TODO:WORK(w)    TODO:HOLD(h)    | TODO:FUTURE(f)   TODO:DONE(d)    TODO:CANCELED(c)
#+PROPERTY: header-args :eval never-export
#+HTML_HEAD: <style>body { width: 95%; margin: 2% auto; font-size: 18px; line-height: 1.4em; font-family: Georgia, serif; color: black; background-color: white; }</style>
# Change max-width to get wider output -- also note #content style below
#+HTML_HEAD: <style>body { min-width: 500px; max-width: 1024px; }</style>
#+HTML_HEAD: <style>h1,h2,h3,h4,h5,h6 { color: #A5573E; line-height: 1em; font-family: Helvetica, sans-serif; }</style>
#+HTML_HEAD: <style>h1,h2,h3 { line-height: 1.4em; }</style>
#+HTML_HEAD: <style>h1.title { font-size: 3em; }</style>
#+HTML_HEAD: <style>.subtitle { font-size: 0.6em; }</style>
#+HTML_HEAD: <style>h4,h5,h6 { font-size: 1em; }</style>
#+HTML_HEAD: <style>.org-src-container { border: 1px solid #ccc; box-shadow: 3px 3px 3px #eee; font-family: Lucida Console, monospace; font-size: 80%; margin: 0px; padding: 0px 0px; position: relative; }</style>
#+HTML_HEAD: <style>.org-src-container>pre { line-height: 1.2em; padding-top: 1.5em; margin: 0.5em; background-color: #404040; color: white; overflow: auto; }</style>
#+HTML_HEAD: <style>.org-src-container>pre:before { display: block; position: absolute; background-color: #b3b3b3; top: 0; right: 0; padding: 0 0.2em 0 0.4em; border-bottom-left-radius: 8px; border: 0; color: white; font-size: 100%; font-family: Helvetica, sans-serif;}</style>
#+HTML_HEAD: <style>pre.example { white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -o-pre-wrap; font-family: Lucida Console, monospace; font-size: 80%; background: #404040; color: white; display: block; padding: 0em; border: 2px solid black; }</style>
#+HTML_HEAD: <style>blockquote { margin-bottom: 0.5em; padding: 0.5em; background-color: #FFF8DC; border-left: 2px solid #A5573E; border-left-color: rgb(255, 228, 102); display: block; margin-block-start: 1em; margin-block-end: 1em; margin-inline-start: 5em; margin-inline-end: 5em; } </style>
# Change the following to get wider output -- also note body style above
#+HTML_HEAD: <style>#content { max-width: 60em; }</style>
#+HTML_LINK_HOME: https://www.mitchr.me/
#+HTML_LINK_UP: https://richmit.github.io/voyager/
# ######################################################################################################################################################.H.E.##

#+ATTR_HTML: :border 2 solid #ccc :frame hsides :align center
|          <r> | <l>                                 |
|    *Author:* | /{{{author}}}/                      |
|   *Updated:* | /{{{modification-time(%Y-%m-%d)}}}/ |
| *Generated:* | /{{{time(%Y-%m-%d)}}}/              |
#+ATTR_HTML: :align center
Copyright \copy {{{time(%Y)}}} Mitch Richling. All rights reserved.

#+TOC: headlines 5

#+MACRO: WBT @@html:<span style='font-family:sans-serif;margin:0;padding:.1em .4em .1em .4em;color:white;background-color:#644117;border-radius:0.3em;'>$1</span>@@
#+MACRO: BBT @@html:<span style='font-family:sans-serif;margin:0;padding:.1em .4em .1em .4em;color:cyan;background-color:#644117;border-radius:0.3em;'>$1</span>@@
#+MACRO: YBT @@html:<span style='font-family:sans-serif;margin:0;padding:.1em .4em .1em .4em;color:yellow;background-color:#644117;border-radius:0.3em;'>$1</span>@@
#+MACRO: SPC @@html:&nbsp;&nbsp;&nbsp;@@
#+MACRO: WFBT @@html:<div style='font-size:70%;text-align:center;width:7em;font-family:sans-serif;margin:0;padding:.1em .4em .1em .4em;color:white;background-color:#644117;border-radius:0.3em;'>$1</div>@@
#+MACRO: BFBT @@html:<div style='font-size:70%;text-align:center;width:7em;font-family:sans-serif;margin:0;padding:.1em .4em .1em .4em;color:cyan;background-color:#644117;border-radius:0.3em;'>$1</div>@@
#+MACRO: YFBT @@html:<div style='font-size:70%;text-align:center;width:7em;font-family:sans-serif;margin:0;padding:.1em .4em .1em .4em;color:yellow;background-color:#644117;border-radius:0.3em;'>$1</div>@@

* Introduction
:PROPERTIES:
:CUSTOM_ID: intro
:END:

I have one "big" program on my HP-16C & DM-16L calculators with 7 entry points:

#+ATTR_HTML: :border 2 solid #ccc :frame hsides :align center
| *=LBL=* | *Function* | *Description*                                  |
|---------+------------+------------------------------------------------|
| *=A=*   | *=SLn=*    | Shift y left by x bits                         |
| *=B=*   | *=SRn=*    | Shift y right by x bits                        |
| *=C=*   | *=ctz=*    | Count Trailing Zeros                           |
| *=E=*   | *=iLog=*   | Integer logarithm: $\mathrm{floor}(\log_2(x))$ |
| *=F=*   | *=WSIZE=*  | Recall the WSIZE value                         |
| *=2=*   | *=2^x=*    | Compute $2^x$                                  |
| *=1=*   | *=LSSB=*   | Clear all but least significant set bit        |

** Stack Diagrams

#+BEGIN_CENTER
*=SLn=* -- Shift y left by x bits
#+END_CENTER
#+ATTR_HTML: :align center :cellpadding 3em
| <c>  | <l>      | <l>       |
|      | *Before* | *After*   |
| *T:* | t        | ?         |
| *Z:* | z        | ?         |
| *Y:* | y        | ?         |
| *X:* | n        | SLn(y, n) |
#+BEGIN_CENTER
*=SRn=* -- Shift y right by x bits
#+END_CENTER
#+ATTR_HTML: :align center :cellpadding 3em
| <c>  | <l>      | <l>       |
|      | *Before* | *After*   |
| *T:* | t        | ?         |
| *Z:* | z        | ?         |
| *Y:* | y        | ?         |
| *X:* | n        | SRn(y, n) |
#+BEGIN_CENTER
*=ctz=* -- Count Trailing Zeros
#+END_CENTER
#+ATTR_HTML: :align center :cellpadding 3em
| <c>  | <l>      | <l>     |
|      | *Before* | *After* |
| *T:* | t        | ?       |
| *Z:* | z        | ?       |
| *Y:* | y        | ?       |
| *X:* | x        | CTZ(x)  |
#+BEGIN_CENTER
*=iLog=* -- Integer logarithm: $\mathrm{floor}(\log_2(x))$
#+END_CENTER
#+ATTR_HTML: :align center :cellpadding 3em
| <c>  | <l>      | <l>     |
|      | *Before* | *After* |
| *T:* | t        | ?       |
| *Z:* | z        | ?       |
| *Y:* | y        | ?       |
| *X:* | x        | iLog(x) |
#+BEGIN_CENTER
*=WSIZE=* -- Recall the WSIZE value
#+END_CENTER
#+ATTR_HTML: :align center :cellpadding 3em
| <c>  | <l>      | <l>     |
|      | *Before* | *After* |
| *T:* | t        | y       |
| *Z:* | z        | y       |
| *Y:* | y        | x       |
| *X:* | x        | WSIZE   |
#+BEGIN_CENTER
*=2^x=* -- Compute $2^x$
#+END_CENTER
#+ATTR_HTML: :align center :cellpadding 3em
| <c>  | <l>      | <l>     |
|      | *Before* | *After* |
| *T:* | t        | z       |
| *Z:* | z        | z       |
| *Y:* | y        | y       |
| *X:* | x        | $2^x$   |
#+BEGIN_CENTER
*=LSSB=* -- Clear all but least significant set bit
#+END_CENTER
#+ATTR_HTML: :align center :cellpadding 3em
| <c>  | <l>      | <l>     |
|      | *Before* | *After* |
| *T:* | t        | y       |
| *Z:* | z        | y       |
| *Y:* | y        | y       |
| *X:* | x        | LSSB(x) |

** Program Listing

#+ATTR_HTML: :align center :cellpadding 1em
| <l>                                      |         <r> |                        <r> |    <c>    | <l>                                                                       |
| *Keystrokes* {{{SPC}}}                   | *Key Codes* | {{{SPC}}} *Stack Contents* | {{{SPC}}} | *Comments*                                                                |
| {{{BBT(g)}}} {{{BBT(LBL)}}} {{{WBT(A)}}} |    43,22, A |                    n y z t |           | {{{WBT(A)}}} *=SLn=*=* -- Shift Left n bits                               |
| {{{WBT(GSB)}}} {{{WBT(2)}}}              |          21 |               2  2^x y z ? |           |                                                                           |
| {{{WBT(×)}}}                             |          20 |               SLn(x) z ? ? |           | Ret                                                                       |
| {{{BBT(g)}}} {{{BBT(RTN)}}}              |       43 21 |                            |           |                                                                           |
| {{{BBT(g)}}} {{{BBT(LBL)}}} {{{WBT(B)}}} |    43,22, b |                    n y z t |           | {{{WBT(B)}}} *=SRn=*=* -- Shift Right n bits                              |
| {{{WBT(GSB)}}} {{{WBT(2)}}}              |       21  2 |                  2^x y z ? |           |                                                                           |
| {{{WBT(÷)}}}                             |          10 |               SRn(x) z ? ? |           | Ret                                                                       |
| {{{BBT(g)}}} {{{BBT(RTN)}}}              |       43 21 |                            |           |                                                                           |
| {{{BBT(g)}}} {{{BBT(LBL)}}} {{{WBT(C)}}} |    43,22, C |                    x y z t |           | {{{WBT(C)}}} *=CTZ=*=* -- Count Trailing Zeros                            |
| {{{BBT(g)}}} {{{BBT(x=0)}}}              |       43 40 |                    x y z t |           |                                                                           |
| {{{WBT(÷)}}}                             |       10  0 |                      y z t |           | Ret when x=0                                                              |
| {{{WBT(GSB)}}} {{{WBT(1)}}}              |       21  1 |                 LSSB y ? ? |           |                                                                           |
| {{{WBT(GSB)}}} {{{WBT(E)}}}              |       21  E |               CTZ(x) y ? ? |           | Ret when x≠0                                                              |
| {{{BBT(g)}}} {{{BBT(RTN)}}}              |       43 21 |                            |           |                                                                           |
| {{{BBT(g)}}} {{{BBT(LBL)}}} {{{WBT(E)}}} |    43,22, E |                    x y z t |           | {{{WBT(E)}}} *=iLog=*=* -- Integer logarithm: $\mathrm{floor}(\log_2(x))$ |
| {{{BBT(g)}}} {{{BBT(x=0)}}}              |       43 49 |                    x y z t |           |                                                                           |
| {{{WBT(÷)}}}                             |          10 |                    0 y z t |           | Ret when x=0                                                              |
| {{{BBT(g)}}} {{{BBT(LJ)}}}               |       43  A |                  c ljx y z |           |                                                                           |
| {{{WBT(X≷Y)}}}                           |          34 |                  ljx c y z |           |                                                                           |
| {{{WBT(R↓)}}}                            |          33 |                  c y z ljx |           |                                                                           |
| {{{WBT(GSB)}}} {{{WBT(F)}}}              |          21 |             F  wsize c y ? |           |                                                                           |
| {{{WBT(1)}}}                             |        1  1 |                  wsize c y |           |                                                                           |
| {{{WBT(-)}}}                             |          30 |              wsize-1 c y y |           |                                                                           |
| {{{WBT(X≷Y)}}}                           |          34 |              c wsize-1 y y |           |                                                                           |
| {{{WBT(-)}}}                             |          30 |              iLog(x) y y y |           | Ret when x≠0                                                              |
| {{{BBT(g)}}} {{{BBT(RTN)}}}              |       43 21 |                            |           |                                                                           |
| {{{BBT(g)}}} {{{BBT(LBL)}}} {{{WBT(F)}}} |    43,22, F |                    x y z t |           | {{{WBT(F)}}} *=WSIZE=*=* -- Recall the WSIZE value                        |
| {{{WBT(1)}}}                             |        1  1 |                      x y z |           |                                                                           |
| {{{BBT(g)}}} {{{BBT(LJ)}}}               |       43  A |                ws-1 1s x y |           |                                                                           |
| {{{WBT(X≷Y)}}}                           |          34 |                1s ws-1 x y |           |                                                                           |
| {{{WBT(R↓)}}}                            |          33 |                ws-1 x y 1s |           |                                                                           |
| {{{WBT(1)}}}                             |           1 |                 1 ws-1 x y |           |                                                                           |
| {{{WBT(+)}}}                             |          40 |                wsize x y y |           | Ret                                                                       |
| {{{BBT(g)}}} {{{BBT(RTN)}}}              |       43 21 |                            |           |                                                                           |
| {{{BBT(g)}}} {{{BBT(LBL)}}} {{{WBT(2)}}} |    43,22, 2 |                    x y z t |           | {{{WBT(2)}}} *=2^x=*=* -- Compute $2^x$                                   |
| {{{WBT(1)}}}                             |           1 |                    1 x y z |           |                                                                           |
| {{{WBT(X≷Y)}}}                           |          34 |                    x 1 y z |           |                                                                           |
| {{{YBT(f)}}} {{{YBT(f RLn)}}}            |          42 |               e  2^X y z z |           | Ret                                                                       |
| {{{BBT(g)}}} {{{BBT(RTN)}}}              |       43 21 |                            |           |                                                                           |
| {{{BBT(g)}}} {{{BBT(LBL)}}} {{{WBT(1)}}} |    43,22, 1 |                    x y z t |           | {{{WBT(1)}}} *=LSSB=*=* -- Clear all but least significant set bit        |
| {{{BBT(g)}}} {{{BBT(x=0)}}}              |       43 40 |                    x y z t |           |                                                                           |
| {{{BBT(g)}}} {{{BBT(RTN)}}}              |       43 21 |                    0 y z t |           | Ret when x=0                                                              |
| {{{WBT(ENTER)}}}                         |          36 |                    x x y z |           |                                                                           |
| {{{WBT(ENTER)}}}                         |          36 |                    x x x y |           |                                                                           |
| {{{WBT(1)}}}                             |           1 |                    1 x x y |           |                                                                           |
| {{{WBT(-)}}}                             |          30 |                    x-1 x y |           |                                                                           |
| {{{YBT(f)}}} {{{YBT(NOT)}}}              |       42 30 |             NOT(x-1) x y y |           |                                                                           |
| {{{YBT(f)}}} {{{YBT(AND)}}}              |       42 20 |              LSSB(x) y y y |           | Ret when x≠0                                                              |
| {{{BBT(g)}}} {{{BBT(RTN)}}}              |       43 21 |                            |           |                                                                           |

